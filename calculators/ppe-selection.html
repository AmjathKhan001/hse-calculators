<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PPE Selection Calculator | HSE Calculator</title>
    <meta name="description" content="Select appropriate personal protective equipment based on workplace hazards and risk assessment.">
    <!-- Same head content -->
</head>
<body>
    <!-- Same header -->

    <section class="calculator-section">
        <div class="container">
            <h1 class="section-title">PPE Selection Calculator</h1>
            <p class="section-subtitle">Select appropriate personal protective equipment based on workplace hazards and risk assessment.</p>
            
            <div class="calculator-form" id="ppe-calculator-form">
                <div class="form-group">
                    <label for="task-description" class="form-label">Task Description:</label>
                    <input type="text" id="task-description" class="form-control" placeholder="e.g., Welding, Chemical handling, Woodworking">
                </div>
                
                <div class="hazard-assessment">
                    <h4 class="section-title">Hazard Assessment</h4>
                    
                    <div class="form-group">
                        <label class="form-label">Physical Hazards:</label>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="impact-hazard">
                                <span class="checkbox-text">Impact/Flying Objects</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="cut-hazard">
                                <span class="checkbox-text">Cutting/Sharp Objects</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="fall-hazard">
                                <span class="checkbox-text">Fall Hazards</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="crush-hazard">
                                <span class="checkbox-text">Crushing/Pinching</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Chemical Hazards:</label>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="splash-hazard">
                                <span class="checkbox-text">Splashes/Sprays</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="vapor-hazard">
                                <span class="checkbox-text">Vapors/Fumes</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="dust-hazard">
                                <span class="checkbox-text">Dust/Particulates</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="corrosive-hazard">
                                <span class="checkbox-text">Corrosive Materials</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Environmental Hazards:</label>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="noise-hazard">
                                <span class="checkbox-text">Noise Exposure</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="heat-hazard">
                                <span class="checkbox-text">Heat/Flame</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="cold-hazard">
                                <span class="checkbox-text">Cold Temperature</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="electrical-hazard">
                                <span class="checkbox-text">Electrical Hazards</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Biological Hazards:</label>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="bloodborne-hazard">
                                <span class="checkbox-text">Bloodborne Pathogens</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="infectious-hazard">
                                <span class="checkbox-text">Infectious Materials</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="mold-hazard">
                                <span class="checkbox-text">Mold/Biological Agents</span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="exposure-level" class="form-label">Exposure Level:</label>
                    <select id="exposure-level" class="form-control">
                        <option value="low">Low - Infrequent, short duration</option>
                        <option value="medium" selected>Medium - Regular, moderate duration</option>
                        <option value="high">High - Continuous, long duration</option>
                        <option value="extreme">Extreme - Emergency response</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="work-environment" class="form-label">Work Environment:</label>
                    <select id="work-environment" class="form-control">
                        <option value="indoor">Indoor - Controlled environment</option>
                        <option value="outdoor" selected>Outdoor - Weather exposure</option>
                        <option value="confined">Confined Space</option>
                        <option value="height">Working at Height</option>
                        <option value="water">Water/Flooded areas</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="task-duration" class="form-label">Task Duration:</label>
                    <select id="task-duration" class="form-control">
                        <option value="short">Short (under 1 hour)</option>
                        <option value="medium" selected>Medium (1-4 hours)</option>
                        <option value="long">Long (4-8 hours)</option>
                        <option value="extended">Extended (over 8 hours)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="worker-mobility" class="form-label">Worker Mobility Required:</label>
                    <select id="worker-mobility" class="form-control">
                        <option value="stationary">Stationary - Limited movement</option>
                        <option value="moderate" selected>Moderate - Some movement</option>
                        <option value="high">High - Frequent movement</option>
                        <option value="extreme">Extreme - Climbing, crawling</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="compatibility-required" class="form-label">PPE Compatibility Required:</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="vision-required" checked>
                            <span class="checkbox-text">Vision (glasses, face shield)</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="communication-required">
                            <span class="checkbox-text">Communication (radio, hearing)</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="dexterity-required">
                            <span class="checkbox-text">Fine Dexterity Required</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="thermal-comfort">
                            <span class="checkbox-text">Thermal Comfort Needed</span>
                        </label>
                    </div>
                </div>
                
                <button id="calculate-ppe" class="btn btn-primary btn-lg">
                    <i class="fas fa-hard-hat"></i> Generate PPE Recommendation
                </button>
                
                <div id="ppe-result" class="result-box" style="display: none;">
                    <h3><i class="fas fa-shield-alt"></i> PPE Selection Recommendations</h3>
                    
                    <div class="result-summary">
                        <div class="summary-card" id="head-protection-card">
                            <div class="summary-icon">
                                <i class="fas fa-hard-hat"></i>
                            </div>
                            <div class="summary-content">
                                <h5>Head Protection</h5>
                                <div class="summary-value" id="head-protection">Required</div>
                            </div>
                        </div>
                        
                        <div class="summary-card" id="respiratory-card">
                            <div class="summary-icon">
                                <i class="fas fa-lungs"></i>
                            </div>
                            <div class="summary-content">
                                <h5>Respiratory</h5>
                                <div class="summary-value" id="respiratory-protection">Not Required</div>
                            </div>
                        </div>
                        
                        <div class="summary-card" id="body-protection-card">
                            <div class="summary-icon">
                                <i class="fas fa-tshirt"></i>
                            </div>
                            <div class="summary-content">
                                <h5>Body Protection</h5>
                                <div class="summary-value" id="body-protection">Required</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="ppe-details mt-4">
                        <h5><i class="fas fa-clipboard-list"></i> Recommended PPE Checklist</h5>
                        <div class="ppe-checklist" id="ppe-checklist"></div>
                    </div>
                    
                    <div class="ppe-specifications mt-4">
                        <h5><i class="fas fa-tags"></i> Equipment Specifications</h5>
                        <div id="ppe-specifications"></div>
                    </div>
                    
                    <div class="ppe-compatibility mt-4">
                        <h5><i class="fas fa-puzzle-piece"></i> Compatibility Notes</h5>
                        <div id="compatibility-notes"></div>
                    </div>
                    
                    <div class="ppe-maintenance mt-4">
                        <h5><i class="fas fa-tools"></i> Maintenance & Inspection</h5>
                        <div id="maintenance-schedule"></div>
                    </div>
                    
                    <div class="print-actions mt-4">
                        <button class="btn btn-primary print-btn" onclick="generatePDF('ppe-calculator-form', 'ppe-selection')">
                            <i class="fas fa-file-pdf"></i> Save as PDF Report
                        </button>
                        <button class="btn btn-secondary" onclick="window.print()">
                            <i class="fas fa-print"></i> Print
                        </button>
                    </div>
                </div>
                
                <div class="calculator-info mt-4">
                    <h4><i class="fas fa-info-circle"></i> PPE Standards & Regulations</h4>
                    
                    <div class="ppe-standards-table">
                        <h5>Common PPE Standards</h5>
                        <table class="risk-matrix">
                            <thead>
                                <tr>
                                    <th>PPE Type</th>
                                    <th>ANSI Standard</th>
                                    <th>EN Standard</th>
                                    <th>Key Requirements</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Head Protection</td>
                                    <td>ANSI Z89.1</td>
                                    <td>EN 397</td>
                                    <td>Impact resistance, dielectric</td>
                                </tr>
                                <tr>
                                    <td>Eye Protection</td>
                                    <td>ANSI Z87.1</td>
                                    <td>EN 166</td>
                                    <td>Impact, optical clarity</td>
                                </tr>
                                <tr>
                                    <td>Hearing Protection</td>
                                    <td>ANSI S3.19</td>
                                    <td>EN 352</td>
                                    <td>Noise Reduction Rating (NRR)</td>
                                </tr>
                                <tr>
                                    <td>Respiratory</td>
                                    <td>NIOSH 42 CFR 84</td>
                                    <td>EN 149</td>
                                    <td>Filter efficiency, fit factor</td>
                                </tr>
                                <tr>
                                    <td>Hand Protection</td>
                                    <td>ANSI/ISEA 105</td>
                                    <td>EN 388</td>
                                    <td>Cut, abrasion, puncture resistance</td>
                                </tr>
                                <tr>
                                    <td>Foot Protection</td>
                                    <td>ANSI Z41</td>
                                    <td>EN ISO 20345</td>
                                    <td>Impact, compression, slip resistance</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="ppe-hierarchy mt-4">
                        <h5><i class="fas fa-sitemap"></i> PPE Selection Hierarchy</h5>
                        <div class="hierarchy-steps">
                            <div class="hierarchy-step">
                                <div class="step-number">1</div>
                                <div class="step-content">
                                    <h6>Hazard Identification</h6>
                                    <p>Identify all potential hazards in the work area</p>
                                </div>
                            </div>
                            <div class="hierarchy-step">
                                <div class="step-number">2</div>
                                <div class="step-content">
                                    <h6>Risk Assessment</h6>
                                    <p>Evaluate severity and probability of exposure</p>
                                </div>
                            </div>
                            <div class="hierarchy-step">
                                <div class="step-number">3</div>
                                <div class="step-content">
                                    <h6>Engineering Controls</h6>
                                    <p>Implement engineering solutions first</p>
                                </div>
                            </div>
                            <div class="hierarchy-step">
                                <div class="step-number">4</div>
                                <div class="step-content">
                                    <h6>Administrative Controls</h6>
                                    <p>Implement work procedures and training</p>
                                </div>
                            </div>
                            <div class="hierarchy-step">
                                <div class="step-number">5</div>
                                <div class="step-content">
                                    <h6>PPE Selection</h6>
                                    <p>Select appropriate PPE as last line of defense</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Social Sharing & Related Calculators -->
            <!-- Same as previous -->
            
        </div>
    </section>

    <!-- Footer -->
    <!-- Same as previous -->

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('calculate-ppe').addEventListener('click', calculatePPESelection);
        });

        function calculatePPESelection() {
            // Get task description
            const taskDescription = document.getElementById('task-description').value || 'General Task';
            
            // Get hazard checkboxes
            const hazards = {
                physical: {
                    impact: document.getElementById('impact-hazard').checked,
                    cut: document.getElementById('cut-hazard').checked,
                    fall: document.getElementById('fall-hazard').checked,
                    crush: document.getElementById('crush-hazard').checked
                },
                chemical: {
                    splash: document.getElementById('splash-hazard').checked,
                    vapor: document.getElementById('vapor-hazard').checked,
                    dust: document.getElementById('dust-hazard').checked,
                    corrosive: document.getElementById('corrosive-hazard').checked
                },
                environmental: {
                    noise: document.getElementById('noise-hazard').checked,
                    heat: document.getElementById('heat-hazard').checked,
                    cold: document.getElementById('cold-hazard').checked,
                    electrical: document.getElementById('electrical-hazard').checked
                },
                biological: {
                    bloodborne: document.getElementById('bloodborne-hazard').checked,
                    infectious: document.getElementById('infectious-hazard').checked,
                    mold: document.getElementById('mold-hazard').checked
                }
            };
            
            // Get other parameters
            const exposureLevel = document.getElementById('exposure-level').value;
            const workEnvironment = document.getElementById('work-environment').value;
            const taskDuration = document.getElementById('task-duration').value;
            const workerMobility = document.getElementById('worker-mobility').value;
            
            // Get compatibility requirements
            const compatibility = {
                vision: document.getElementById('vision-required').checked,
                communication: document.getElementById('communication-required').checked,
                dexterity: document.getElementById('dexterity-required').checked,
                thermal: document.getElementById('thermal-comfort').checked
            };
            
            // Generate PPE recommendations
            const ppeRecommendations = generatePPERecommendations(
                hazards, exposureLevel, workEnvironment, 
                taskDuration, workerMobility, compatibility
            );
            
            // Generate maintenance schedule
            const maintenance = generateMaintenanceSchedule(exposureLevel, taskDuration);
            
            // Display results
            displayPPEResults({
                taskDescription,
                hazards,
                exposureLevel,
                workEnvironment,
                taskDuration,
                workerMobility,
                compatibility,
                ppeRecommendations,
                maintenance
            });
            
            document.getElementById('ppe-result').style.display = 'block';
        }

        function generatePPERecommendations(hazards, exposureLevel, workEnvironment, taskDuration, workerMobility, compatibility) {
            const recommendations = {
                head: [],
                eye: [],
                hearing: [],
                respiratory: [],
                hand: [],
                foot: [],
                body: [],
                fall: [],
                specialized: []
            };
            
            // Head protection
            if (hazards.physical.impact || workEnvironment === 'height' || workEnvironment === 'confined') {
                recommendations.head.push({
                    item: 'Safety Helmet',
                    type: 'Type I, Class G (General)',
                    standard: 'ANSI Z89.1 / EN 397',
                    notes: 'Dielectric if electrical hazards present',
                    required: true
                });
            }
            
            // Eye protection
            if (hazards.physical.impact || hazards.chemical.splash || hazards.environmental.heat) {
                recommendations.eye.push({
                    item: 'Safety Glasses',
                    type: 'Side-shield protection',
                    standard: 'ANSI Z87.1+ / EN 166',
                    notes: 'Anti-fog coating recommended',
                    required: true
                });
                
                if (hazards.chemical.splash || hazards.environmental.heat) {
                    recommendations.eye.push({
                        item: 'Face Shield',
                        type: 'Additional protection',
                        standard: 'ANSI Z87.1 / EN 166',
                        notes: 'Wear over safety glasses',
                        required: true
                    });
                }
            }
            
            // Hearing protection
            if (hazards.environmental.noise) {
                const exposureFactor = exposureLevel === 'high' || exposureLevel === 'extreme' ? 1.5 : 1;
                recommendations.hearing.push({
                    item: 'Hearing Protection',
                    type: exposureFactor > 1 ? 'Earmuffs (NRR 25+)' : 'Earplugs (NRR 20+)',
                    standard: 'ANSI S3.19 / EN 352',
                    notes: 'Double protection for extreme noise',
                    required: true
                });
            }
            
            // Respiratory protection
            if (hazards.chemical.vapor || hazards.chemical.dust || hazards.biological.any()) {
                let respiratorType = 'N95 Mask';
                let standard = 'NIOSH 42 CFR 84';
                
                if (hazards.chemical.vapor) {
                    respiratorType = 'Organic Vapor Cartridge';
                }
                if (hazards.chemical.corrosive) {
                    respiratorType = 'Acid Gas Cartridge';
                }
                if (hazards.biological.bloodborne || hazards.biological.infectious) {
                    respiratorType = 'N95 or better for biological';
                }
                
                recommendations.respiratory.push({
                    item: 'Respirator',
                    type: respiratorType,
                    standard: standard,
                    notes: 'Fit testing required',
                    required: true
                });
            }
            
            // Hand protection
            if (hazards.physical.cut || hazards.chemical.splash || hazards.environmental.heat || hazards.environmental.cold) {
                let gloveType = 'General Purpose';
                let material = 'Nitrile';
                let standard = 'ANSI/ISEA 105';
                
                if (hazards.physical.cut) {
                    gloveType = 'Cut Resistant';
                    material = 'Kevlar/Steel Mesh';
                }
                if (hazards.chemical.corrosive) {
                    gloveType = 'Chemical Resistant';
                    material = 'Butyl Rubber';
                }
                if (hazards.environmental.heat) {
                    gloveType = 'Heat Resistant';
                    material = 'Leather/Kevlar';
                }
                if (hazards.environmental.cold) {
                    gloveType = 'Cold Insulated';
                    material = 'Insulated Leather';
                }
                
                recommendations.hand.push({
                    item: 'Safety Gloves',
                    type: `${gloveType} Gloves`,
                    material: material,
                    standard: standard,
                    notes: compatibility.dexterity ? 'Select for dexterity' : 'Standard thickness',
                    required: true
                });
            }
            
            // Foot protection
            if (hazards.physical.impact || hazards.physical.crush || hazards.environmental.electrical) {
                recommendations.foot.push({
                    item: 'Safety Boots',
                    type: hazards.environmental.electrical ? 'Dielectric Boots' : 'Steel Toe',
                    standard: 'ANSI Z41 / EN ISO 20345',
                    features: 'Steel toe, slip resistant sole',
                    required: true
                });
            }
            
            // Body protection
            if (hazards.chemical.splash || hazards.environmental.heat || workEnvironment === 'outdoor') {
                let clothingType = 'Coveralls';
                let material = 'Cotton/Polyester';
                
                if (hazards.chemical.splash) {
                    clothingType = 'Chemical Splash Suit';
                    material = 'Tyvek or similar';
                }
                if (hazards.environmental.heat) {
                    clothingType = 'Flame Resistant Clothing';
                    material = 'Nomex or FR Cotton';
                }
                if (hazards.chemical.corrosive) {
                    clothingType = 'Acid Resistant Suit';
                    material = 'PVC or Rubber';
                }
                
                recommendations.body.push({
                    item: 'Protective Clothing',
                    type: clothingType,
                    material: material,
                    notes: workEnvironment === 'outdoor' ? 'Weather appropriate' : 'Standard issue',
                    required: true
                });
            }
            
            // Fall protection
            if (hazards.physical.fall || workEnvironment === 'height') {
                recommendations.fall.push({
                    item: 'Fall Arrest System',
                    type: 'Full Body Harness',
                    components: 'Harness, lanyard, anchor point',
                    standard: 'ANSI Z359 / EN 361',
                    notes: 'Requires proper training',
                    required: true
                });
            }
            
            // Specialized equipment
            if (workEnvironment === 'confined') {
                recommendations.specialized.push({
                    item: 'Confined Space Equipment',
                    type: 'Retrieval system, gas monitor',
                    notes: 'Entry permit required',
                    required: true
                });
            }
            
            if (workEnvironment === 'water') {
                recommendations.specialized.push({
                    item: 'Flotation Device',
                    type: 'Personal Flotation Device (PFD)',
                    standard: 'USCG Approved',
                    notes: 'Type III or better',
                    required: true
                });
            }
            
            return recommendations;
        }

        function generateMaintenanceSchedule(exposureLevel, taskDuration) {
            const schedules = {
                inspection: {
                    daily: [],
                    weekly: [],
                    monthly: [],
                    quarterly: []
                },
                replacement: [],
                cleaning: []
            };
            
            // Inspection schedules based on exposure
            if (exposureLevel === 'high' || exposureLevel === 'extreme') {
                schedules.inspection.daily.push('Visual inspection of all PPE before use');
                schedules.inspection.daily.push('Check for damage, wear, or deterioration');
            } else {
                schedules.inspection.weekly.push('Complete PPE inspection');
            }
            
            // Replacement schedules
            const replacementItems = [
                { item: 'Respirator filters', frequency: 'Monthly or when breathing becomes difficult' },
                { item: 'Earplug inserts', frequency: 'Weekly or when dirty/damaged' },
                { item: 'Safety glasses', frequency: 'When scratched or damaged' },
                { item: 'Gloves', frequency: 'Daily for disposable, weekly for reusable' },
                { item: 'Hard hat', frequency: 'Every 5 years or after impact' }
            ];
            
            schedules.replacement = replacementItems;
            
            // Cleaning schedules
            schedules.cleaning = [
                'Clean reusable PPE after each use',
                'Use manufacturer-recommended cleaning agents',
                'Store PPE in clean, dry location',
                'Allow PPE to dry completely before storage'
            ];
            
            return schedules;
        }

        function displayPPEResults(data) {
            // Update summary cards
            document.getElementById('head-protection').textContent = 
                data.ppeRecommendations.head.length > 0 ? 'Required' : 'Not Required';
            document.getElementById('respiratory-protection').textContent = 
                data.ppeRecommendations.respiratory.length > 0 ? 'Required' : 'Not Required';
            document.getElementById('body-protection').textContent = 
                data.ppeRecommendations.body.length > 0 ? 'Required' : 'Not Required';
            
            // Update card colors
            document.getElementById('head-protection-card').className = 
                `summary-card ${data.ppeRecommendations.head.length > 0 ? 'status-high' : 'status-low'}`;
            document.getElementById('respiratory-card').className = 
                `summary-card ${data.ppeRecommendations.respiratory.length > 0 ? 'status-high' : 'status-low'}`;
            document.getElementById('body-protection-card').className = 
                `summary-card ${data.ppeRecommendations.body.length > 0 ? 'status-high' : 'status-low'}`;
            
            // Display PPE checklist
            const checklistHtml = generateChecklistHTML(data.ppeRecommendations);
            document.getElementById('ppe-checklist').innerHTML = checklistHtml;
            
            // Display specifications
            const specsHtml = generateSpecificationsHTML(data.ppeRecommendations);
            document.getElementById('ppe-specifications').innerHTML = specsHtml;
            
            // Display compatibility notes
            const compatHtml = generateCompatibilityHTML(data.compatibility);
            document.getElementById('compatibility-notes').innerHTML = compatHtml;
            
            // Display maintenance schedule
            const maintHtml = generateMaintenanceHTML(data.maintenance);
            document.getElementById('maintenance-schedule').innerHTML = maintHtml;
        }

        function generateChecklistHTML(recommendations) {
            let html = '<div class="checklist-container">';
            
            Object.keys(recommendations).forEach(category => {
                if (recommendations[category].length > 0) {
                    html += `<div class="checklist-category">`;
                    html += `<h6>${category.toUpperCase()} PROTECTION</h6>`;
                    html += `<ul>`;
                    
                    recommendations[category].forEach(item => {
                        html += `<li class="checklist-item">`;
                        html += `<input type="checkbox" id="check-${category}-${item.item.replace(/\s+/g, '-')}">`;
                        html += `<label for="check-${category}-${item.item.replace(/\s+/g, '-')}">`;
                        html += `<strong>${item.item}</strong> - ${item.type}`;
                        if (item.notes) html += `<br><small>${item.notes}</small>`;
                        html += `</label>`;
                        html += `</li>`;
                    });
                    
                    html += `</ul></div>`;
                }
            });
            
            html += '</div>';
            return html;
        }

        function generateSpecificationsHTML(recommendations) {
            let html = '<div class="specs-container">';
            
            Object.keys(recommendations).forEach(category => {
                recommendations[category].forEach(item => {
                    html += `<div class="spec-item">`;
                    html += `<h6>${item.item}</h6>`;
                    html += `<div class="spec-details">`;
                    if (item.type) html += `<p><strong>Type:</strong> ${item.type}</p>`;
                    if (item.material) html += `<p><strong>Material:</strong> ${item.material}</p>`;
                    if (item.standard) html += `<p><strong>Standard:</strong> ${item.standard}</p>`;
                    if (item.features) html += `<p><strong>Features:</strong> ${item.features}</p>`;
                    if (item.notes) html += `<p><strong>Notes:</strong> ${item.notes}</p>`;
                    html += `</div></div>`;
                });
            });
            
            html += '</div>';
            return html;
        }

        function generateCompatibilityHTML(compatibility) {
            let html = '<div class="compatibility-notes">';
            
            if (compatibility.vision) {
                html += `<div class="compatibility-item">`;
                html += `<i class="fas fa-glasses"></i>`;
                html += `<span>Ensure eye protection fits over prescription glasses</span>`;
                html += `</div>`;
            }
            
            if (compatibility.communication) {
                html += `<div class="compatibility-item">`;
                html += `<i class="fas fa-broadcast-tower"></i>`;
                html += `<span>Select hearing protection compatible with communication devices</span>`;
                html += `</div>`;
            }
            
            if (compatibility.dexterity) {
                html += `<div class="compatibility-item">`;
                html += `<i class="fas fa-hand-paper"></i>`;
                html += `<span>Choose gloves that allow fine motor skills</span>`;
                html += `</div>`;
            }
            
            if (compatibility.thermal) {
                html += `<div class="compatibility-item">`;
                html += `<i class="fas fa-temperature-low"></i>`;
                html += `<span>Consider thermal comfort for extended wear</span>`;
                html += `</div>`;
            }
            
            html += `<div class="compatibility-item">`;
            html += `<i class="fas fa-exclamation-triangle"></i>`;
            html += `<span>Test PPE compatibility before task begins</span>`;
            html += `</div>`;
            
            html += '</div>';
            return html;
        }

        function generateMaintenanceHTML(maintenance) {
            let html = '<div class="maintenance-container">';
            
            // Inspection schedule
            html += `<div class="maintenance-section">`;
            html += `<h6>Inspection Schedule</h6>`;
            
            Object.keys(maintenance.inspection).forEach(frequency => {
                if (maintenance.inspection[frequency].length > 0) {
                    html += `<div class="frequency-group">`;
                    html += `<strong>${frequency.charAt(0).toUpperCase() + frequency.slice(1)}:</strong>`;
                    html += `<ul>`;
                    maintenance.inspection[frequency].forEach(item => {
                        html += `<li>${item}</li>`;
                    });
                    html += `</ul></div>`;
                }
            });
            
            html += `</div>`;
            
            // Replacement schedule
            html += `<div class="maintenance-section">`;
            html += `<h6>Replacement Schedule</h6>`;
            html += `<ul>`;
            maintenance.replacement.forEach(item => {
                html += `<li><strong>${item.item}:</strong> ${item.frequency}</li>`;
            });
            html += `</ul></div>`;
            
            // Cleaning instructions
            html += `<div class="maintenance-section">`;
            html += `<h6>Cleaning Instructions</h6>`;
            html += `<ul>`;
            maintenance.cleaning.forEach(instruction => {
                html += `<li>${instruction}</li>`;
            });
            html += `</ul></div>`;
            
            html += '</div>';
            return html;
        }

        function generatePDF(elementId, filename) {
            const element = document.getElementById(elementId);
            
            const opt = {
                margin: 0.5,
                filename: `${filename}-${new Date().getTime()}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
            };
            
            html2pdf().set(opt).from(element).save();
        }
    </script>
</body>
</html>
